var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$scope","$http",function(e,t){function o(e){var t=e.charAt(0).toUpperCase()+e.slice(1);return function(e){return-1!=e.primary_cat.indexOf(t)}}e.saveToProject=function(){var o={category:e.category,subcategory:e.subcategory,warm_Id:e.warmId,weight:parseFloat(e.weight)*e.conversion,units:e.unit.name};console.log(o),t.post("/addToProject").then(function(e){console.log(e)})},e.newCalculation=function(){console.log("Calculating...",e.weight);var o={warmId:e.warmId||e.category.secondaries[0].warm_id,weight:parseFloat(e.weight)*e.conversion};console.log(o),t.post("/calculations",o).then(function(t){e.result=Math.floor(1e3*Math.abs(t.data))/1e3,console.log(e.result)})},e.querySearch=function(t){return console.log(e.list.filter(o(t))),void 0==e.cateogry&&console.log(e.subcategory,e.category),t?e.list.filter(o(t)):e.list},t.get("/materials").then(function(t){var o=t.data;o.forEach(function(e){e.primary_cat=e.primary_cat.charAt(0).toUpperCase()+e.primary_cat.slice(1).toLowerCase()}),e.list=o}),e.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}]}]),app.controller("loginCtrl",["$scope","$http","authService",function(e,t,o){e.login=function(){t({method:"POST",url:"/login",data:e.user}).then(function(e){o.saveToken(e.data.token)})}}]),app.controller("createAccountCtrl",["$scope","$http",function(e,t){e.user={},e.processForm=function(o){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){t({method:"POST",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records})}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkc2NvcGUiLCIkaHR0cCIsImNyZWF0ZUZpbHRlckZvciIsInF1ZXJ5IiwibG93ZXJjYXNlUXVlcnkiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwib2JqIiwicHJpbWFyeV9jYXQiLCJpbmRleE9mIiwic2F2ZVRvUHJvamVjdCIsImxpbmVJdGVtIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1fSWQiLCJ3YXJtSWQiLCJ3ZWlnaHQiLCJwYXJzZUZsb2F0IiwiY29udmVyc2lvbiIsInVuaXRzIiwidW5pdCIsIm5hbWUiLCJjb25zb2xlIiwibG9nIiwicG9zdCIsInRoZW4iLCJyZXNwb25zZSIsIm5ld0NhbGN1bGF0aW9uIiwiY2FsY3VsYXRlIiwic2Vjb25kYXJpZXMiLCJ3YXJtX2lkIiwicmVzdWx0IiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwibGlzdCIsImZpbHRlciIsInVuZGVmaW5lZCIsImNhdGVvZ3J5IiwiZ2V0IiwiZm9yRWFjaCIsIml0ZW0iLCJ0b0xvd2VyQ2FzZSIsImF1dGhTZXJ2aWNlIiwibG9naW4iLCJtZXRob2QiLCJ1cmwiLCJ1c2VyIiwic2F2ZVRva2VuIiwidG9rZW4iLCJwcm9jZXNzRm9ybSIsImRhdGFUeXBlIiwiYWxlcnQiLCJuYW1lcyIsInJlY29yZHMiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsImJhc2U2NFVybCIsInNwbGl0IiwiYmFzZTY0IiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImxvZ291dCIsImdldFVzZXIiLCJmYWN0b3J5IiwiJHEiLCIkbG9jYXRpb24iLCJyZXF1ZXN0IiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxjQUFlLFVBQVcsYUFBYyxjQUVqRUYsS0FBSUcsUUFBUSxxQkFBc0IsaUJBQWtCLG9CQUFxQixnQkFBaUIsU0FBU0MsRUFBb0JDLEVBQWdCQyxFQUFtQkMsR0FDdEpELEVBQWtCRSxXQUFVLEdBRzVCSixFQUFtQkssTUFBTSxXQUNwQkMsZUFBZSxTQUNmQyxjQUFjLGFBQWNDLFVBQVUsUUFDdENDLFlBQWEsVUFHbEJSLEVBQWVTLEtBQUssS0FFWkMsWUFBYSx5QkFDYkMsV0FBWSxrQkFDYkYsS0FBSyxVQUVKQyxZQUFhLG9CQUNiQyxXQUFZLEtBQ2JGLEtBQUssYUFFSkMsWUFBYSx1QkFDYkMsV0FBWSxzQkFDYkYsS0FBSyxZQUVKQyxZQUFhLHNCQUNiQyxXQUFZLEtBQ2JGLEtBQUssY0FFSkMsWUFBYSx3QkFDYkMsV0FBWSxpQkFDYkYsS0FBSyxhQUVKQyxZQUFhLHNCQUNiQyxXQUFZLGlCQUNiRixLQUFLLFVBRUpDLFlBQWEsc0JBQ2RELEtBQUssWUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxLQUNiRixLQUFLLFlBRUpDLFlBQWEsd0JBQ2RFLFdBQ0NDLFdBQVksU0FPeEJsQixJQUFJZ0IsV0FBVyxpQkFBa0IsU0FBVSxRQUFTLFNBQVNHLEVBQVFDLEdBOEVqRSxRQUFTQyxHQUFnQkMsR0FD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QUtBLFFBQVEsSUFBSyxJQUN0RCxPQUFPQyxNQUFLQyxNQUFNUixFQUFRUyxLQUFLSixJQUM1QixVQUdYSixLQUFLVCxVQUFZLFNBQVVDLEdBQ3ZCTyxFQUFRVSxhQUFhQyxTQUFXbEIsRUFDaEM3QixRQUFRQyxJQUFJLGVBQWVtQyxFQUFRVSxhQUFhQyxXQUdwRFYsS0FBS1csU0FBVyxXQUNaLE1BQU9aLEdBQVFVLGFBQWFDLFVBR2hDVixLQUFLWSxTQUFXLFdBQ1osR0FBSXBCLEdBQVFRLEtBQUtXLFVBQ2pCLElBQUluQixFQUFPLENBQ1AsR0FBSXFCLEdBQVNiLEtBQUtDLFNBQVNULEdBQ3ZCc0IsRUFBYXpDLEtBQUswQyxPQUFNLEdBQUlDLE9BQU9DLFVBQVksTUFBU0osRUFBT0ssR0FJbkUsT0FIS0osSUFDRGQsS0FBS21CLFNBRUZMLEVBRVAsT0FBTyxHQUlmZCxLQUFLbUIsT0FBUyxpQkFDSHBCLEdBQVFVLGFBQWFDLFVBSWhDVixLQUFLb0IsUUFBVSxXQUNYLE1BQU9wQixNQUFLQyxTQUFTRCxLQUFLVyxnQkFJbEMxRixJQUFJb0csUUFBUSxtQkFBb0IsS0FBTSxZQUFhLGNBQWUsU0FBVUMsRUFBSUMsRUFBV3JDLEdBQ3ZGLE9BQ0lzQyxRQUFTLFNBQVVwRyxHQUtmLE1BSkFBLEdBQU9xRyxRQUFVckcsRUFBT3FHLFlBQ3BCdkMsRUFBWTBCLGFBQ1p4RixFQUFPcUcsUUFBUUMsY0FBZ0IsVUFBWXhDLEVBQVl5QixZQUVwRHZGLEdBRVgyQyxTQUFVLFNBQVVBLEdBT2hCLE1BTHdCLE9BQXBCQSxFQUFTNEQsUUFHVEosRUFBVUssS0FBSyxVQUVaN0QsR0FBWXVELEVBQUd2RixLQUFLZ0MsSUFDNUI4RCxjQUFlLFNBQVU5RCxHQU94QixNQU53QixPQUFwQkEsRUFBUzRELE9BQ1RKLEVBQVVLLEtBQUssVUFHZmpFLFFBQVFDLElBQUlHLEdBRVR1RCxFQUFHUSxPQUFPL0QiLCJmaWxlIjoic2NyaXB0cy9hcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2Vjb3RvbmVBcHAnLCBbJ25nUm91dGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3JlZ2lzdGVyJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlQWNjb3VudEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hY2NvdW50JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWNjb3VudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9kYXNoYm9hcmQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcHJvamVjdHMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcm9qZWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCdcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCdcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3ByaXZhY3knLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcml2YWN5Lmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pO1xuXG4gICAgLy9NLy9kZXNpZ25hdGUgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbi8vIGNyZWF0ZSBvYmplY3QgdG8gc2VuZCB0byBiYWNrZW5kIGZvciBjYWxjdWxhdGlvblxuXG4gICAgJHNjb3BlLnNhdmVUb1Byb2plY3QgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogJHNjb3BlLmNhdGVnb3J5LFxuICAgICAgICAgICAgc3ViY2F0ZWdvcnk6ICRzY29wZS5zdWJjYXRlZ29yeSxcbiAgICAgICAgICAgIHdhcm1fSWQ6ICRzY29wZS53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoJHNjb3BlLndlaWdodCkqJHNjb3BlLmNvbnZlcnNpb24sXG4gICAgICAgICAgICB1bml0czogJHNjb3BlLnVuaXQubmFtZVxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICRzY29wZS5uZXdDYWxjdWxhdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FsY3VsYXRpbmcuLi5cIiwgJHNjb3BlLndlaWdodCk7XG4gICAgICAgIHZhciBjYWxjdWxhdGUgPSB7XG4gICAgICAgICAgICB3YXJtSWQ6ICRzY29wZS53YXJtSWQgfHwgJHNjb3BlLmNhdGVnb3J5LnNlY29uZGFyaWVzWzBdLndhcm1faWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoJHNjb3BlLndlaWdodCkqJHNjb3BlLmNvbnZlcnNpb25cbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2coY2FsY3VsYXRlKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2NhbGN1bGF0aW9ucycsIGNhbGN1bGF0ZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgJHNjb3BlLnJlc3VsdCA9IE1hdGguZmxvb3IoTWF0aC5hYnMocmVzcG9uc2UuZGF0YSkgKiAxMDAwKSAvIDEwMDA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucmVzdWx0KTtcblxuICAgICAgICB9KTtcbiAgICB9O1xuXG4vL2F1dG9jb21wbGV0ZSBmdW5jdGlvbmFsaXR5XG4gICAgJHNjb3BlLnF1ZXJ5U2VhcmNoPWZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5saXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSk7XG4gICAgICAgIGlmKCRzY29wZS5jYXRlb2dyeSA9PSB1bmRlZmluZWQgfHwgbnVsbCl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuc3ViY2F0ZWdvcnksICRzY29wZS5jYXRlZ29yeSk7XG4gICAgICAgICAgICAvLyRzY29wZS5zdWJjYXRlZ29yeSA9PSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeSA/ICRzY29wZS5saXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6ICRzY29wZS5saXN0O1xuICAgIH07XG5cbi8vbG9hZCBQcmltYXJ5IGNhdGVnb3JpZXMgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICAkaHR0cC5nZXQoJy9tYXRlcmlhbHMnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBsaXN0ID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICAvL2l0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgIC8vIGNhdXNpbmcgYnVncyByaWdodCBub3dcbiAgICAgICAgICAgIGl0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbS5wcmltYXJ5X2NhdC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUubGlzdCA9IGxpc3Q7XG5cbiAgICB9KTtcblxuLy9sb2FkIHRoZSB1bml0c1xuICAgICRzY29wZS51bml0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2xicycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMDVcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2tpbG9zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDAuMDAxMTAyMzFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ3RvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbWV0cmljIHRvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMS4xMDIzMVxuICAgICAgICB9XG4gICAgXTtcbi8vXG5cbi8vQ3JlYXRlIGZpbHRlciBmdW5jdGlvbiBmb3IgYSBxdWVyeSBzdHJpbmdcbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhxdWVyeSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cob2JqLnByaW1hcnlfY2F0KTtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG59XSk7XG5cblxuLy8gTG9naW4gSFRNTCAtIEthdGVcbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgfSlcbiAgICB9XG59XSk7XG5cbi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7XG5cbi8vIFByb2plY3QgSFRNTCAtIERhc2hib2FyZCBIVE1MIC0gS2ltXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJGh0dHAoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xuXG5cbn1dKTtcblxuLy8gU2VydmljZXMgZm9yIGF1dGhlbnRpY2F0aW9uXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdyl7XG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
